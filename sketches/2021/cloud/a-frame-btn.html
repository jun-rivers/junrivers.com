<!DOCTYPE html>
<html lang="en">
	<head>
		<title>button to open window</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<link type="text/css" rel="stylesheet" href="main.css?v=0.3">
	</head>

	<body>
		<div id="info">
			<h3>
				AFrame Test<a href="https://threejs.org" target="_blank" rel="noopener noreferrer"></a> <!-- audio visualizer -->
				04
			</h3>
		</div>

		<div id="overlay">
			<button id="startButton">Open</button>
			<br/>
			<button id="closeButton">Close</button>
		</div>

		<script type="module">
			let arScanner;

			const startButton = document.getElementById( 'startButton' );
			startButton.addEventListener( 'click', function () {

				arScanner = window.open('http://localhost:8000/a-frame-04.html?p=ad8xs-0hh6n&m=Flamingo.glb&d=1000&s=2.5', '_blank', 'directories=no,titlebar=no,toolbar=no,location=no,status=no,menubar=no,scrollbars=no,resizable=no');
			      	window.sendARMessage = ((trigger) => {
				        console.log('init sendARMessage')
				        console.log(trigger)
				        return (msg)=> {
				          console.log('sendARMessage')
				          console.log(trigger)
				          arScanner?.close()
				          console.log(msg);
			        	}
			     	}
			    )("trigger")
			});

			const closeButton = document.getElementById( 'closeButton' );
			closeButton.addEventListener( 'click', function () {

				arScanner.close();

			} );

		</script>

	</body>
</html>